<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Notebook 4: Sampling distributions</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/united.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<div class="container-fluid main-container">

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->





<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Bootstrap course</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="resources.html">Resources</a>
</li>
<li>
  <a href="exercises.html">Exercises</a>
</li>
<li>
  <a href="activities.html">Activities</a>
</li>
<li>
  <a href="https://twitter.com/robustgar">
    <span class="fa fa-twitter-square"></span>
     
  </a>
</li>
<li>
  <a href="https://garstats.wordpress.com">
    <span class="fa fa-wordpress"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/GRousselet/bootcourse">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Notebook 4: Sampling distributions</h1>

</div>


<pre class="r"><code># dependencies
library(ggplot2)
library(tibble)</code></pre>
<div id="sampling-distributions" class="section level1">
<h1>Sampling distributions</h1>
<div id="sampling-from-a-normal-distribution" class="section level2">
<h2>Sampling from a normal distribution</h2>
<div id="population" class="section level3">
<h3>Population</h3>
<pre class="r"><code>m &lt;- 50 # population mean
sd &lt;- 10 # population standard deviation

ggplot(data.frame(x = c(0, 100)), aes(x)) + theme_linedraw() +
  stat_function(fun = dnorm, args = list(mean = m, sd = sd)) + 
labs(y = &quot;Density&quot;) +
  theme(axis.text = element_text(size = 14),
        axis.title = element_text(size = 16),
        plot.title = element_text(size=20)) +
  ggtitle(paste0(&quot;Normal distribution: mean = &quot;,m,&quot;, sd = &quot;,sd))</code></pre>
<p><img src="nb4_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<pre class="r"><code># ggsave(filename = &quot;./figures/nb4_normdist.pdf&quot;)</code></pre>
</div>
<div id="one-sample" class="section level3">
<h3>One sample</h3>
<pre class="r"><code>set.seed(4)
n &lt;- 20 # sample size
samp &lt;- rnorm(n, m, sd) # generate random sample

ggplot(data.frame(x = c(0, 100)), aes(x)) + theme_linedraw() +
  stat_function(fun = dnorm, args = list(mean = m, sd = sd)) +
  geom_vline(xintercept = samp, colour = &quot;grey&quot;) + 
labs(y = &quot;Density&quot;) +
  theme(axis.text = element_text(size = 14),
        axis.title = element_text(size = 16),
        plot.title = element_text(size=20)) +
  ggtitle(paste0(&quot;Normal distribution: mean = &quot;,m,&quot;, sd = &quot;,sd))</code></pre>
<p><img src="nb4_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<pre class="r"><code># ggsave(filename = &quot;./figures/nb4_normdist_1samp.pdf&quot;)</code></pre>
</div>
<div id="one-sample-mean" class="section level3">
<h3>One sample + mean</h3>
<p>Same figure as above with the sample mean superimposed.</p>
<pre class="r"><code>set.seed(4)
n &lt;- 20
samp &lt;- rnorm(n, m, sd)
ggplot(data.frame(x = c(0, 100)), aes(x)) + theme_linedraw() +
  stat_function(fun = dnorm, args = list(mean = m, sd = sd)) +
  geom_vline(xintercept = samp, colour = &quot;grey&quot;) +
  geom_vline(xintercept = mean(samp), size = 2) + 
labs(y = &quot;Density&quot;) +
  theme(axis.text = element_text(size = 14),
        axis.title = element_text(size = 16),
        plot.title = element_text(size=20)) +
  ggtitle(paste(&quot;Sample mean =&quot;,round(mean(samp),digits=1),&quot;, sd = &quot;,round(sd(samp),digits=1)))</code></pre>
<p><img src="nb4_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<pre class="r"><code># ggsave(filename = &quot;./figures/nb4_normdist_1samp_mean.pdf&quot;)</code></pre>
</div>
<div id="sampling-distribution" class="section level3">
<h3>Sampling distribution</h3>
<p>Now we do 10,000 experiments, each time sampling from the same normal distribution and computing the sample mean. The graph below illustrates 10,000 sample means.</p>
<pre class="r"><code>set.seed(111) 
n &lt;- 20 # sample size
nsim &lt;- 10000 # number of simulations / experiments
# generate sampling distribution in one go:
samp.dist &lt;- apply(matrix(rnorm(n*nsim, m, sd),nrow = nsim), 1, mean)

ggplot(data.frame(x=samp.dist), aes(x)) + theme_linedraw() +
  geom_histogram(aes(y = ..density..), colour = &quot;black&quot;, fill = &quot;white&quot;, bins = 50) +
  theme(axis.text = element_text(size = 14),
        axis.title = element_text(size = 16),
        plot.title = element_text(size=20)) +
  ggtitle(paste(nsim,&quot;sample means: mean =&quot;,round(mean(samp.dist),digits=1),&quot;, sd = &quot;,round(sd(samp.dist),digits=2)))</code></pre>
<p><img src="nb4_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<pre class="r"><code># ggsave(filename = &quot;./figures/nb4_normdist_10000samp_mean.pdf&quot;)</code></pre>
</div>
<div id="standard-error-of-the-mean" class="section level3">
<h3>Standard error of the mean</h3>
<p>SEM is defined as: population sd / sqrt(n)</p>
<pre class="r"><code>sd / sqrt(n)</code></pre>
<pre><code>## [1] 2.236068</code></pre>
<p>In practice, we do not have access to the population, so SEM is usually estimated using sample sd / sqrt(n).</p>
<p>SEM can also be defined as the sd of the sampling distribution of the sample mean.</p>
<pre class="r"><code>sd(samp.dist)</code></pre>
<pre><code>## [1] 2.255003</code></pre>
<p>This value is very close to the previous one. If we increase the size of sampling distribution, by computing 100,000 or 1,000,000 or more sample means, the standard deviation of the sampling distribution will converge towards 2.236 precisely.</p>
<p>For more on the SEM, see this excellent <a href="https://www.khanacademy.org/math/ap-statistics/sampling-distribution-ap/sampling-distribution-mean/v/standard-error-of-the-mean">video</a>.</p>
</div>
</div>
<div id="example-using-the-lognormal" class="section level2">
<h2>Example using the lognormal</h2>
<p><a href="https://msalganik.wordpress.com/2017/01/21/making-sense-of-the-rlnorm-function-in-r/">Blog post</a> on how to use <code>rlnorm()</code>.</p>
<div id="illustrate-lognormal" class="section level3">
<h3>Illustrate lognormal</h3>
<pre class="r"><code># population
m &lt;- 5
s &lt;- 5
location &lt;- log(m^2 / sqrt(s^2 + m^2))
shape &lt;- sqrt(log(1 + (s^2 / m^2)))
x &lt;- seq(0, 20, .05)
ggplot(tibble::enframe(x), aes(value)) +
  theme_linedraw() +
  stat_function(fun = dlnorm, args = list(meanlog = location, sdlog = shape), size = 1) +
  labs(y = &quot;Density&quot;) +
  theme(axis.title = element_text(size = 16),
        axis.text = element_text(size = 14),
        plot.title = element_text(size=20)) +
  ggtitle(paste0(&quot;Log normal distribution: mean = &quot;,m,&quot;, sd = &quot;,s))</code></pre>
<p><img src="nb4_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<pre class="r"><code># ggsave(filename = &quot;./figures/nb4_lnormdist.pdf&quot;)</code></pre>
</div>
<div id="one-sample-from-lognormal-distribution" class="section level3">
<h3>One sample from lognormal distribution</h3>
<pre class="r"><code>set.seed(777)
n &lt;- 20
samp &lt;- rlnorm(n, meanlog = location, sdlog = shape)
x &lt;- seq(0, 20, .05)
ggplot(as_tibble(x), aes(value)) +
  theme_linedraw() +
  stat_function(fun = dlnorm, args = list(meanlog = location, sdlog = shape), size = 1) +
  geom_vline(xintercept = samp, colour = &quot;grey&quot;) + 
  geom_vline(xintercept = mean(samp), size = 1.5) + 
labs(y = &quot;Density&quot;) +
  theme(axis.text = element_text(size = 14),
        axis.title = element_text(size = 16),
        plot.title = element_text(size=20)) +
  ggtitle(paste0(&quot;Log normal distribution: mean = &quot;,m,&quot;, sd = &quot;,sd))</code></pre>
<p><img src="nb4_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<pre class="r"><code># ggsave(filename = &quot;./figures/nb4_lnormdist_1samp.pdf&quot;)</code></pre>
</div>
<div id="many-samples-from-lognormal-distribution" class="section level3">
<h3>Many samples from lognormal distribution</h3>
<pre class="r"><code>set.seed(777)
m &lt;- 5
s &lt;- 5
location &lt;- log(m^2 / sqrt(s^2 + m^2))
shape &lt;- sqrt(log(1 + (s^2 / m^2)))

# population mean?
lnorm.pop.m &lt;- mean(rlnorm(1000000, meanlog = location, sdlog = shape))

n &lt;- 20
nsamp &lt;- 10000
# nsamp experiments in one go + compute mean for each one:
dist.samp &lt;- apply(matrix(rlnorm(n*nsamp, meanlog = location, sdlog = shape), nrow = nsamp), 1, mean)

v &lt;- as_tibble(dist.samp) 
ggplot(v, aes(x = value)) + theme_linedraw() +
        geom_histogram(aes(y = ..density..), colour = &quot;black&quot;, fill = &quot;white&quot;, bins = 50) +
  # geom_vline(xintercept = mean(dist.samp), size = 1.5) + 
  theme(axis.text = element_text(size = 14),
        axis.title = element_text(size = 16),
        plot.title = element_text(size=20)) +
  ggtitle(paste(nsim,&quot;sample means: mean =&quot;,round(mean(dist.samp),digits=1),&quot;, sd = &quot;,round(sd(dist.samp),digits=2)))</code></pre>
<p><img src="nb4_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<pre class="r"><code># ggsave(filename = &quot;./figures/nb4_lnormdist_10000samp_mean.pdf&quot;)</code></pre>
</div>
<div id="sem" class="section level3">
<h3>SEM</h3>
<p>Based on (otherwise unobservable) population:</p>
<pre class="r"><code>s / sqrt(n)</code></pre>
<pre><code>## [1] 1.118034</code></pre>
<p>Based on (otherwise unachievable) 10,000 experiments:</p>
<pre class="r"><code>sd(dist.samp)</code></pre>
<pre><code>## [1] 1.121328</code></pre>
<p>Based on one sample:</p>
<pre class="r"><code>sd(samp) / sqrt(n)</code></pre>
<pre><code>## [1] 1.172885</code></pre>
</div>
</div>
</div>
<div id="bootstrap-sampling-distribution" class="section level1">
<h1>Bootstrap sampling distribution</h1>
<div id="example-1-samples-from-a-standard-normal-distribution" class="section level2">
<h2>Example 1: samples from a standard normal distribution</h2>
<div id="sampling-distribution-1" class="section level3">
<h3>Sampling distribution</h3>
<pre class="r"><code>set.seed(777)
n &lt;- 100 # sample size
nsamp &lt;- 10000 # number of samples (experiments)
# sampling distribution of the mean
dist.samp &lt;- apply(matrix(rnorm(n*nsamp), nrow = nsamp), 1, mean)
v &lt;- enframe(dist.samp, name = NULL) 
ggplot(v, aes(x = value)) +
        geom_histogram(aes(y = ..density..), 
                       bins = 40,  colour = &quot;black&quot;, fill = &quot;white&quot;) +
        geom_line(aes(y = ..density.., colour = &#39;Sampling&#39;), stat = &#39;density&#39;, size = 1) +     
        scale_colour_manual(name = &quot;Distributions&quot;, values = &quot;orange1&quot;) +
  theme(legend.position = c(0.1, 0.85),
        axis.title = element_text(size = 16),
        axis.text = element_text(size = 14),
        legend.text = element_text(size = 12),
        legend.title = element_text(size = 14)
       )</code></pre>
<p><img src="nb4_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<pre class="r"><code># ggsave(filename = &#39;./figures/nb4_norm_samp_dist.pdf&#39;)</code></pre>
</div>
<div id="sampling-distribution-bootstrap-distribution-1" class="section level3">
<h3>Sampling distribution + bootstrap distribution [1]</h3>
<p>The bootstrap distribution can approximate the sampling distribution very well for n = 100 and nboot = 1000. Comment out set.seed, so that different random numbers are generated each time you run the chunk. What happens for different random samples?</p>
<p>What happens for lower values of n and nboot? What do you conclude?</p>
<pre class="r"><code>set.seed(777)
n &lt;- 100 # sample size 
samp &lt;- rnorm(n) # create sample from normal population
nboot &lt;- 1000 # number of bootstrap samples
nsamp &lt;- 10000 # number of samples (experiments)
# bootstrap distribution
boot.samp &lt;- apply(matrix(sample(samp, n*nboot, replace = TRUE), nrow = nboot), 1, mean)
# sampling distribution of the mean
dist.samp &lt;- apply(matrix(rnorm(n*nsamp), nrow = nsamp), 1, mean)
v &lt;- enframe(dist.samp, name = NULL) 
ggplot(v, aes(x = value)) +
        geom_histogram(aes(y = ..density..), 
                       bins = 40,  colour = &quot;black&quot;, fill = &quot;white&quot;) +
        geom_line(aes(y = ..density.., colour = &#39;Sampling&#39;), stat = &#39;density&#39;, size = 1) +     
        # stat_function(fun = dnorm, aes(colour = &#39;Normal&#39;),
        #                  args = list(mean = mean(boot.samp), sd = sd(boot.samp)), size = 1) +
        geom_line(data = as_tibble(boot.samp),  
                  aes(x = value, y = ..density.., colour = &#39;Bootstrap&#39;), 
                  stat = &#39;density&#39;, size = 1) +
        scale_colour_manual(name = &quot;Distributions&quot;, values = c(&quot;green4&quot;, &quot;orange1&quot;)) +
  theme(legend.position = c(0.1, 0.85),
        axis.title = element_text(size = 16),
        axis.text = element_text(size = 14),
        legend.text = element_text(size = 12),
      legend.title = element_text(size = 14)
       )</code></pre>
<p><img src="nb4_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r"><code># ggsave(filename = &#39;./figures/nb4_norm_samp_dist_boot.pdf&#39;)</code></pre>
</div>
<div id="sampling-distribution-bootstrap-distribution-2" class="section level3">
<h3>Sampling distribution + bootstrap distribution [2]</h3>
<pre class="r"><code>set.seed(666)
n &lt;- 100 # sample size 
samp &lt;- rnorm(n) # create sample from normal population
nboot &lt;- 1000 # number of bootstrap samples
nsamp &lt;- 10000 # number of samples (experiments)
# bootstrap distribution
boot.samp &lt;- apply(matrix(sample(samp, n*nboot, replace = TRUE), nrow = nboot), 1, mean)
# sampling distribution of the mean
dist.samp &lt;- apply(matrix(rnorm(n*nsamp), nrow = nsamp), 1, mean)
v &lt;- enframe(dist.samp, name = NULL) 
ggplot(v, aes(x = value)) +
        geom_histogram(aes(y = ..density..), 
                       bins = 40,  colour = &quot;black&quot;, fill = &quot;white&quot;) +
        geom_line(aes(y = ..density.., colour = &#39;Sampling&#39;), stat = &#39;density&#39;, size = 1) +     
        # stat_function(fun = dnorm, aes(colour = &#39;Normal&#39;),
        #                  args = list(mean = mean(boot.samp), sd = sd(boot.samp)), size = 1) +
        geom_line(data = as_tibble(boot.samp),  
                  aes(x = value, y = ..density.., colour = &#39;Bootstrap&#39;), 
                  stat = &#39;density&#39;, size = 1) +
        scale_colour_manual(name = &quot;Distributions&quot;, values = c(&quot;green4&quot;, &quot;orange1&quot;)) +
  theme(legend.position = c(0.1, 0.85),
        axis.title = element_text(size = 16),
        axis.text = element_text(size = 14),
        legend.text = element_text(size = 12),
      legend.title = element_text(size = 14)
       )</code></pre>
<p><img src="nb4_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<pre class="r"><code># ggsave(filename = &#39;./figures/nb4_norm_samp_dist_boot2.pdf&#39;)</code></pre>
</div>
</div>
<div id="example-2-sample-from-gamma-distribution" class="section level2">
<h2>Example 2: sample from gamma distribution</h2>
<div id="check-shape-of-gamme-distribution" class="section level3">
<h3>Check shape of gamme distribution</h3>
<pre class="r"><code>x &lt;- seq(0, 15, .05)
ggplot(tibble::enframe(x), aes(value)) +
  theme_linedraw() +
  stat_function(fun = dgamma, args = list(shape = 2, scale = 2), size = 1) +
  theme(axis.title = element_text(size = 16),
        axis.text = element_text(size = 14))</code></pre>
<p><img src="nb4_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<pre class="r"><code># ggsave(filename = &#39;./figures/nb4_gamma_dist.pdf&#39;)</code></pre>
</div>
<div id="sampling-distribution-bootstrap-distribution-1-1" class="section level3">
<h3>Sampling distribution + bootstrap distribution [1]</h3>
<pre class="r"><code>set.seed(777) 
n &lt;- 100
gamma_shape &lt;- 2
gamma_scale &lt;- 2
# sample n trials from gamma distribution
samp &lt;- rgamma(n, shape = gamma_shape, scale = gamma_scale)
nboot &lt;- 1000
nsamp &lt;- 10000
# bootstrap distribution
boot.samp &lt;- apply(matrix(sample(samp, n*nboot, replace = TRUE), nrow = nboot), 1, mean)
# sampling distribution of the mean of n trials from gamma distribution
dist.samp &lt;- apply(matrix(rgamma(n*nsamp, shape = gamma_shape, scale = gamma_scale), nrow = nsamp), 1, mean)
v &lt;- enframe(dist.samp, name = NULL) 
ggplot(v, aes(x = value)) +
        geom_histogram(aes(y = ..density..), 
                       bins = 40,  colour = &quot;black&quot;, fill = &quot;white&quot;) +
        geom_line(aes(y = ..density.., colour = &#39;Sampling&#39;), stat = &#39;density&#39;, size = 1) +     
        # stat_function(fun = dnorm, aes(colour = &#39;Normal&#39;),
        #                  args = list(mean = mean(boot.samp), sd = sd(boot.samp)), size = 1) +
        geom_line(data = as_tibble(boot.samp),  
                  aes(x = value, y = ..density.., colour = &#39;Bootstrap&#39;), 
                  stat = &#39;density&#39;, size = 1) +
        scale_colour_manual(name = &quot;Distributions&quot;, values = c(&quot;green4&quot;, &quot;orange1&quot;)) +
  theme(legend.position = c(0.1, 0.85),
        axis.title = element_text(size = 16),
        axis.text = element_text(size = 14),
        legend.text = element_text(size = 12),
      legend.title = element_text(size = 14)
       )</code></pre>
<p><img src="nb4_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<pre class="r"><code># ggsave(filename = &#39;./figures/nb4_gamma_samp_dist_boot.pdf&#39;)</code></pre>
</div>
<div id="sampling-distribution-bootstrap-distribution-2-1" class="section level3">
<h3>Sampling distribution + bootstrap distribution [2]</h3>
<pre class="r"><code>set.seed(666) 
n &lt;- 100
gamma_shape &lt;- 2
gamma_scale &lt;- 2
# sample n trials from gamma distribution
samp &lt;- rgamma(n, shape = gamma_shape, scale = gamma_scale)
nboot &lt;- 1000
nsamp &lt;- 10000
# bootstrap distribution
boot.samp &lt;- apply(matrix(sample(samp, n*nboot, replace = TRUE), nrow = nboot), 1, mean)
# sampling distribution of the mean of n trials from gamma distribution
dist.samp &lt;- apply(matrix(rgamma(n*nsamp, shape = gamma_shape, scale = gamma_scale), nrow = nsamp), 1, mean)
v &lt;- enframe(dist.samp, name = NULL) 
ggplot(v, aes(x = value)) +
        geom_histogram(aes(y = ..density..), 
                       bins = 40,  colour = &quot;black&quot;, fill = &quot;white&quot;) +
        geom_line(aes(y = ..density.., colour = &#39;Sampling&#39;), stat = &#39;density&#39;, size = 1) +     
        # stat_function(fun = dnorm, aes(colour = &#39;Normal&#39;),
        #                  args = list(mean = mean(boot.samp), sd = sd(boot.samp)), size = 1) +
        geom_line(data = as_tibble(boot.samp),  
                  aes(x = value, y = ..density.., colour = &#39;Bootstrap&#39;), 
                  stat = &#39;density&#39;, size = 1) +
        scale_colour_manual(name = &quot;Distributions&quot;, values = c(&quot;green4&quot;, &quot;orange1&quot;)) +
  theme(legend.position = c(0.1, 0.85),
        axis.title = element_text(size = 16),
        axis.text = element_text(size = 14),
        legend.text = element_text(size = 12),
      legend.title = element_text(size = 14)
       )</code></pre>
<p><img src="nb4_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<pre class="r"><code># ggsave(filename = &#39;./figures/nb4_gamma_samp_dist_boot2.pdf&#39;)</code></pre>
</div>
</div>
</div>

<p> </p>
<p> </p>
<p> </p>
<p>Guillaume A. Rousselet, 2019, University of Glasgow.</p>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
